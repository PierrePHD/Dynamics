


    LFOR = MOTS FX FY FZ FR FT MX MY MZ MT ;
    L_f = MOTS UX UY UZ UR UT RX RY RZ RT ;

    Pb Cal_T = PR_CreationProb;

    K = Pb.K;
    M = Pb.M;
    CL_TOT = Pb.CL_TOT;
    CHA_TOT = Pb.CHA_TOT;
    U0 = Pb.U0;
    V0 = Pb.V0;
    P_intere = Pb.P_intere;
    DirPriv = Pb.DirPriv;
    Nb_NL = DIME (Pb.Tab_NL) ;

    dt = Cal_T.dt;
    Ttot = Cal_T.Ttot;

    En_Nb_Re = PR_TailVectTemp dt Ttot;
    Vec_T = PROG 0. PAS dt Ttot ;

    C = ((1e-4*K) ET (1e4*M)) * 0.1;
    * !!!! Valeur de l amortissement ici
    CL_A = CL_TOT;
    schema = 3 ;
    alpha = 0.0;
    beta = 0.25;
    gamma = 0.5;

    TEMPS ZERO;
    Solu1 = PR_ResolutionTtot M C K CL_A CHA_TOT
                    alpha beta gamma dt Ttot U0 V0;

    TEMPS;


    *Solu2 = PR_ResolutionTtot M C K CL_A FOR2 alpha beta gamma dt Ttot U0 V0;
    *list Solu1;


    TEMPS ZERO;
    FamiF = TABLE;
    FamiG = TABLE;
    *Creation des modes dep imposes non nuls et dep initiaux

    FamiF.Cal = TABLE;
    FamiG.Cal = TABLE;

        FamiF.Imp = TABLE;
        FamiG.Imp = TABLE;
        FamiF.Ini = TABLE;
        FamiG.Ini = TABLE;


    NbModCal = 5;
    OPT0 = TABLE;
    OPT0.Orth = VRAI;
    OPT0.Upda = VRAI;

    PR_ResolutionPGD NbModCal;

    TEMPS;

    *OPTI TRAC PSC;

        AffMods = LECT 1 2 3 4 5;
        AffSolu = LECT 1 2 3 4 5;

    PR_AffichageDepNoeud AffMods AffSolu P_intere DirPriv 0.5;

    PR_AffichageModesEspace AffMods;

    ErrDep ErrEner = PR_CalculErreurAffichGlobal DirPriv VRAI;

    opti donn 5 ;


    CHA_TOT0 = CHA_TOT;


    PR_AffichageDepNoeud AffMods AffSolu P_intere DirPriv 0.3;
    * !!!! Utiliser
    // PR_Eval_Force_NL NL_Tab*TABLE lambda*FLOTTANT Val_Scal*LOGIQUE
    //                         Val_U/FLOTTANT Val_V/FLOTTANT CHP_U/CHPOINT CHP_V/CHPOINT ;
    CHA_NL = PR_EvalNonLin 0.3;
    CHA_TOT = CHA_TOT0 et CHA_NL ;
    Evo_NL  = EXTR CHA_NL 'EVOL' ;
    EvoNLTot = Evo_NL;
    Solu1 = PR_ResolutionTtot M C K CL_A CHA_TOT
                    alpha beta gamma dt Ttot U0 V0;

            FamiF.Cal = TABLE;
            FamiG.Cal = TABLE;
            NbModCal = 1;
            AffMods = LECT 1 ;
            AffSolu = LECT 1 ;
        PR_ResolutionPGD NbModCal;


    PR_AffichageDepNoeud AffMods AffSolu P_intere DirPriv 0.3;
    CHA_NL = PR_EvalNonLin 0.3;
    CHA_TOT = CHA_TOT0 et CHA_NL ;
    Evo_NL  = EXTR CHA_NL 'EVOL' ;
    EvoNLTot = EvoNLTot + Evo_NL;
        FamiF.Cal = TABLE;
        FamiG.Cal = TABLE;
        NbModCal = 1;
    PR_ResolutionPGD NbModCal;
    Solu1 = PR_ResolutionTtot M C K CL_A CHA_TOT
                    alpha beta gamma dt Ttot U0 V0;
    PR_AffichageDepNoeud AffMods AffSolu P_intere DirPriv 0.3;
    CHA_NL = PR_EvalNonLin 0.3;
    CHA_TOT = CHA_TOT0 et CHA_NL ;
    Evo_NL  = EXTR CHA_NL 'EVOL' ;
    EvoNLTot = EvoNLTot + Evo_NL;
        FamiF.Cal = TABLE;
        FamiG.Cal = TABLE;
        NbModCal = 1;
    PR_ResolutionPGD NbModCal;
    Solu1 = PR_ResolutionTtot M C K CL_A CHA_TOT
                    alpha beta gamma dt Ttot U0 V0;
    PR_AffichageDepNoeud AffMods AffSolu P_intere DirPriv 0.3;
    CHA_NL = PR_EvalNonLin 0.3;
    CHA_TOT = CHA_TOT0 et CHA_NL ;
    Evo_NL  = EXTR CHA_NL 'EVOL' ;
    EvoNLTot = EvoNLTot + Evo_NL;
        FamiF.Cal = TABLE;
        FamiG.Cal = TABLE;
        NbModCal = 1;
    PR_ResolutionPGD NbModCal;
    Solu1 = PR_ResolutionTtot M C K CL_A CHA_TOT
                    alpha beta gamma dt Ttot U0 V0;
    PR_AffichageDepNoeud AffMods AffSolu P_intere DirPriv 0.3;
    CHA_NL = PR_EvalNonLin 0.3;
    CHA_TOT = CHA_TOT0 et CHA_NL ;
    Evo_NL  = EXTR CHA_NL 'EVOL' ;
    EvoNLTot = EvoNLTot + Evo_NL;
        FamiF.Cal = TABLE;
        FamiG.Cal = TABLE;
        NbModCal = 1;
    PR_ResolutionPGD NbModCal;
    Solu1 = PR_ResolutionTtot M C K CL_A CHA_TOT
                    alpha beta gamma dt Ttot U0 V0;
    PR_AffichageDepNoeud AffMods AffSolu P_intere DirPriv 0.3;
    CHA_NL = PR_EvalNonLin 0.3;
    CHA_TOT = CHA_TOT0 et CHA_NL ;
    Evo_NL  = EXTR CHA_NL 'EVOL' ;
    EvoNLTot = EvoNLTot + Evo_NL;
        FamiF.Cal = TABLE;
        FamiG.Cal = TABLE;
        NbModCal = 1;
    PR_ResolutionPGD NbModCal;
    Solu1 = PR_ResolutionTtot M C K CL_A CHA_TOT
                    alpha beta gamma dt Ttot U0 V0;
    PR_AffichageDepNoeud AffMods AffSolu P_intere DirPriv 0.3;
    CHA_NL = PR_EvalNonLin 0.3;
    CHA_TOT = CHA_TOT0 et CHA_NL ;
    Evo_NL  = EXTR CHA_NL 'EVOL' ;
    EvoNLTot = EvoNLTot + Evo_NL;
        FamiF.Cal = TABLE;
        FamiG.Cal = TABLE;
        NbModCal = 1;
    PR_ResolutionPGD NbModCal;
    Solu1 = PR_ResolutionTtot M C K CL_A CHA_TOT
                    alpha beta gamma dt Ttot U0 V0;
    PR_AffichageDepNoeud AffMods AffSolu P_intere DirPriv 0.4;
    CHA_NL = PR_EvalNonLin 0.4;
    CHA_TOT = CHA_TOT0 et CHA_NL ;
    Evo_NL  = EXTR CHA_NL 'EVOL' ;
    EvoNLTot = EvoNLTot + Evo_NL;
        FamiF.Cal = TABLE;
        FamiG.Cal = TABLE;
        NbModCal = 1;
    PR_ResolutionPGD NbModCal;
    Solu1 = PR_ResolutionTtot M C K CL_A CHA_TOT
                    alpha beta gamma dt Ttot U0 V0;
    PR_AffichageDepNoeud AffMods AffSolu P_intere DirPriv 0.4;
    CHA_NL = PR_EvalNonLin 0.4;
    CHA_TOT = CHA_TOT0 et CHA_NL ;
    Evo_NL  = EXTR CHA_NL 'EVOL' ;
    EvoNLTot = EvoNLTot + Evo_NL;
        FamiF.Cal = TABLE;
        FamiG.Cal = TABLE;
        NbModCal = 1;
    PR_ResolutionPGD NbModCal;
    Solu1 = PR_ResolutionTtot M C K CL_A CHA_TOT
                    alpha beta gamma dt Ttot U0 V0;
    PR_AffichageDepNoeud AffMods AffSolu P_intere DirPriv 0.4;
    CHA_NL = PR_EvalNonLin 0.4;
    CHA_TOT = CHA_TOT0 et CHA_NL ;
    Evo_NL  = EXTR CHA_NL 'EVOL' ;
    EvoNLTot = EvoNLTot + Evo_NL;
        FamiF.Cal = TABLE;
        FamiG.Cal = TABLE;
        NbModCal = 1;
    PR_ResolutionPGD NbModCal;
    Solu1 = PR_ResolutionTtot M C K CL_A CHA_TOT
                    alpha beta gamma dt Ttot U0 V0;
    PR_AffichageDepNoeud AffMods AffSolu P_intere DirPriv 0.4;
    CHA_NL = PR_EvalNonLin 0.4;
    CHA_TOT = CHA_TOT0 et CHA_NL ;
    Evo_NL  = EXTR CHA_NL 'EVOL' ;
    EvoNLTot = EvoNLTot + Evo_NL;
        FamiF.Cal = TABLE;
        FamiG.Cal = TABLE;
        NbModCal = 1;
    PR_ResolutionPGD NbModCal;
    Solu1 = PR_ResolutionTtot M C K CL_A CHA_TOT
                    alpha beta gamma dt Ttot U0 V0;
    PR_AffichageDepNoeud AffMods AffSolu P_intere DirPriv 0.4;
    CHA_NL = PR_EvalNonLin 0.4;
    CHA_TOT = CHA_TOT0 et CHA_NL ;
    Evo_NL  = EXTR CHA_NL 'EVOL' ;
    EvoNLTot = EvoNLTot + Evo_NL;
        FamiF.Cal = TABLE;
        FamiG.Cal = TABLE;
        NbModCal = 1;
    PR_ResolutionPGD NbModCal;
    Solu1 = PR_ResolutionTtot M C K CL_A CHA_TOT
                    alpha beta gamma dt Ttot U0 V0;
    PR_AffichageDepNoeud AffMods AffSolu P_intere DirPriv 0.4;

    *FamiF.Imp.1 = FamiF.Cal.1 ;
    *FamiG.Imp.1 = FamiG.Cal.1 ;

    opti donn 5;


    * Attention multiplier par 2 ampli pour corespondance avec matlab.

    *opti donn 5 ;

    *Pas_inte = 250;

        *trac Solu1.u.Pas_inte Pb.geo;

        *rec_sol = PR_PGD_to_Full 3;
        *trac rec_sol.u.Pas_inte Pb.geo;
        *BLA = EXCO DirPriv rec_sol.u.Pas_inte;
        *Def1 = DEFO Pb.geo rec_sol.u.Pas_inte;
        *Ampli = (MAXI BLA) - (MINI BLA);
        *    list Ampli;
        *trac (ABS BLA) Def1;



    *AffMods = LECT 1 ;
    *PR_AffichageModesEspace AffMods;

    *New_G= PR_Update;



    *
    opti sort bla;
    sort EXCE Sol_dir SEPA ESPA;
