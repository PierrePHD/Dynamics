

    Pb Cal_T = PR_CreationProb;

    K = Pb.K;
    M = Pb.M;
    CL_TOT = Pb.CL_TOT;
    CHA_TOT = Pb.CHA_TOT;
    U0 = Pb.U0;
    V0 = Pb.V0;
    P_intere = Pb.P_intere;

    dt = Cal_T.dt;
    Ttot = Cal_T.Ttot;

    En_Nb_Re = PR_TailVectTemp dt Ttot;
    Vec_T = PROG 0. PAS dt Ttot ;

    C = ((1e-4*K) ET (1e4*M)) *0.1;
    CL_A = CL_TOT;
    schema = 3 ;
    alpha = 0.0;
    beta = 0.25;
    gamma = 0.5;

    TEMPS ZERO;
    Solu1 = PR_ResolutionTtot M C K CL_A CHA_TOT
                    alpha beta gamma dt Ttot U0 V0;
    * CALCULER AMPLITUDE ICI

    TEMPS;

    *Solu2 = PR_ResolutionTtot M C K CL_A FOR2 alpha beta gamma dt Ttot U0 V0;
    *list Solu1;


    TEMPS ZERO;
    FamiF = TABLE;
    FamiG = TABLE;
    *Creation des modes dep imposes non nuls et dep initiaux

    FamiF.Cal = TABLE;
    FamiG.Cal = TABLE;

        FamiF.Imp = TABLE;
        FamiG.Imp = TABLE;
        FamiF.Ini = TABLE;
        FamiG.Ini = TABLE;

    NbModCal = 1;
    OPT0 = TABLE;
    OPT0.Orth = FAUX;


    DirPriv = 'UZ';

    PR_ResolutionPGD NbModCal;

    Mess 'SORTIE' ;

    TEMPS;

    AffMods = LECT 1 2 ;
    AffSolu = LECT 1 2 ;
    *OPTI TRAC PSC;
    PR_AffichageDepNoeud AffMods AffSolu P_intere DirPriv;
    * Attention multiplier par 2 ampli pour corespondance avec matlab.

    *opti donn 5 ;

    *Pas_inte = 250;

        *trac Solu1.u.Pas_inte Pb.geo;

        *rec_sol = PR_PGD_to_Full 3;
        *trac rec_sol.u.Pas_inte Pb.geo;
        *BLA = EXCO DirPriv rec_sol.u.Pas_inte;
        *Def1 = DEFO Pb.geo rec_sol.u.Pas_inte;
        *Ampli = (MAXI BLA) - (MINI BLA);
        *    list Ampli;
        *trac (ABS BLA) Def1;


    ErrDep ErrEner = PR_CalculErreur DirPriv VRAI;

    *AffMods = LECT 1 ;
    *PR_AffichageModesEspace AffMods;

    *New_G= PR_Update;

    opti donn 5;


    *
    opti sort bla;
    sort EXCE Sol_dir SEPA ESPA;
